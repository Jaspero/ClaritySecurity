<form *ngIf="form$ | async as form" [formGroup]="form" [ngSwitch]="currentState">
  <section class="primary bg p-x-s p-y-m flex jc-between ai-center">
    <h6 *ngSwitchCase="viewState.Edit">{{form.get('name').value}}</h6>
    <h6 *ngSwitchCase="viewState.New">New Module</h6>
    <h6 *ngSwitchCase="viewState.Copy">Copy of {{form.get('name').value}}</h6>
    <div>
      <a mat-button (click)="back()">Cancel</a>
      <button
        mat-flat-button
        [disabled]="form.invalid"
        [jpLoadClick]="save(form)">
        Save
      </button>
    </div>
  </section>

  <section class="grid" *ngSwitchCase="viewState.Edit">
    <div class="col-12 flex ai-center">
      <button mat-button (click)="duplicate(form)">
        <mat-icon>filter_none</mat-icon>
        <span>&nbsp;Duplicate</span>
      </button>
      <div class="flex1"></div>
      <button mat-icon-button aria-label="Previous category" matTooltip="Previous category" (click)="move(false, form)">
        <mat-icon>arrow_back</mat-icon>
      </button>
      <button mat-icon-button aria-label="Next category" matTooltip="Next category" (click)="move(true, form)">
        <mat-icon>arrow_forward</mat-icon>
      </button>
    </div>
  </section>

  <section class="grid fw-rev">
    <div class="col-8 col-s-12">
      <mat-card>
        <mat-tab-group>
          <mat-tab label="Schema">
            <section class="p-t-s">
              <jms-json-editor formControlName="schema"></jms-json-editor>
            </section>
          </mat-tab>
          <mat-tab label="Layout">
            <section class="p-t-s">
              <jms-json-editor formControlName="layout"></jms-json-editor>
            </section>
          </mat-tab>
          <mat-tab label="Definitions">
            <section class="p-t-s">
              <jms-json-editor formControlName="definitions"></jms-json-editor>
            </section>
          </mat-tab>
        </mat-tab-group>
      </mat-card>
    </div>
    <div class="col-4 col-s-12">
      <mat-card>
        <h6>Module Info</h6>
        <div class="p-y-m">
          <mat-divider></mat-divider>
        </div>
        <mat-form-field class="w-full" appearance="outline">
          <mat-label>ID</mat-label>
          <input matInput formControlName="id">
          <mat-hint *ngIf="currentState !== viewState.Edit">Autogenerated if left empty.</mat-hint>
        </mat-form-field>
        <mat-form-field class="w-full" appearance="outline">
          <mat-label>Name</mat-label>
          <input matInput formControlName="name">
        </mat-form-field>
        <mat-form-field class="w-full" appearance="outline">
          <mat-label>Description</mat-label>
          <textarea matInput  formControlName="description"></textarea>
        </mat-form-field>
      </mat-card>
    </div>
  </section>
</form>
